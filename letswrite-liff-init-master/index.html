<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="X-UA-Compatible" content="ie=edge"/>
    <title>WEBEX 線上會議邀請</title>
    <link rel="canonical" href="https://erichuang921.github.io/cth-wbx-invite/index.html"/>
    <meta property="og:url" content="https://erichuang921.github.io/cth-wbx-invite/index.html"/>
    <meta property="fb:app_id" content="911000986339138"/>
    <meta property="og:type" content="website"/>
    <meta property="og:site_name" content="Poling Says 柏林說故事 技術提供"/>
    <meta property="og:title" content="WEBEX 線上會議邀請"/>
    <meta property="og:image:width" content="1200"/>
    <meta property="og:image:height" content="630"/>
    <meta property="og:image:alt" content="LIFF v2 基本使用筆記及範例"/>
    <link rel="shortcut icon" href="https://erichuang921.github.io/cth-wbx-invite/favicon.png"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/skeleton/2.0.4/skeleton.min.css"/>
    <link rel="stylesheet" href="dist/style.min.css?v=1.1.3"/>
  </head>
  <body>
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <script src="dist/main.min.js?v=1.1.4"></script>
    <script src="src/main.js"></script>
    <div class="container" id="app">
      <h1>WEBEX 線上會議邀請</h1>
      <section class="row">
        <div class="twelve column">
          <!-- 傳訊息-->
          <div class="box" id="message">
            <h2>傳訊息</h2>
            <ul>
              <li>會用你的帳號傳訊息</li>
              <li>傳送訊息給朋友：登入 LINE 帳號即可使用</li>
              <li>這邊傳訊息的部份，是用你的帳號傳訊息到 好友、聊天室、群組、機器人</li>
              <li>使用者登入時的「傳送訊息至聊天室」要是「許可」</li>
            </ul>
            <h3>WEBEX 線上會議邀請</h3>
            <input class="u-full-width" id="meeting-url" type="text" placeholder="請填入會議室連結"/>
            <input class="u-full-width" id="meeting-inviter" type="text" placeholder="請填入會議邀請人名稱 (會顯示在邀請畫面上)"/>
            <input class="u-full-width" id="meeting-start" type="text" placeholder="請填入會議開始時間"/>
            <input class="u-full-width" id="meeting-end" type="text" placeholder="請填入會議結束時間"/>
            <button id="sendShareTarget" onclick="share()">傳送會議邀請</button>

<script>// 發送訊息給朋友
function myFunction() {
  const btnShareTarget = document.getElementById('sendShareTarget');
  btnShareTarget.addEventListener('click', () => {
    let webexurl = document.getElementById('meeting-url').value;
    let minviter = document.getElementById('meeting-inviter').value;
    let mstart = document.getElementById('meeting-start').value;
    let mend = document.getElementById('meeting-end').value;
    if(isLoggedIn && liff.isApiAvailable('shareTargetPicker')) {
      liff.shareTargetPicker([
        {
          "type": "flex",
          "altText": "WEBEX 線上會議邀請",
          "contents": {
              "type": "bubble",
              "hero": {
                "type": "image",
                "size": "full",
                "aspectRatio": "20:13",
                "aspectMode": "cover",
                },
                "url": "https://erichuang921.github.io/cth-wbx-invite/WEBEX.png"
              },
              "body": {
                "type": "box",
                "layout": "vertical",
                "contents": [
                  {
                    "type": "text",
                    "text": "WEBEX 會議邀請",
                    "weight": "bold",
                    "size": "xl"
                  },
                  {
                    "type": "box",
                    "layout": "vertical",
                    "margin": "lg",
                    "spacing": "sm",
                    "contents": [
                      {
                        "type": "box",
                        "layout": "baseline",
                        "spacing": "sm",
                        "contents": [
                          {
                            "type": "text",
                            "text": "邀請人",
                            "color": "#aaaaaa",
                            "size": "sm",
                            "flex": 1
                          },
                          {
                            "type": "text",
                            "text": minviter,
                            "wrap": true,
                            "color": "#666666",
                            "size": "sm",
                            "flex": 5
                          }
                        ]
                      },
                      {
                        "type": "box",
                        "layout": "baseline",
                        "spacing": "sm",
                        "contents": [
                          {
                            "type": "text",
                            "text": "會議時間",
                            "color": "#aaaaaa",
                            "size": "sm",
                            "flex": 1
                          },
                          {
                            "type": "text",
                            "text": mstart + " ~ " + mend,
                            "wrap": true,
                            "color": "#666666",
                            "size": "sm",
                            "flex": 5
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              "footer": {
                "type": "box",
                "layout": "vertical",
                "spacing": "sm",
                "contents": [
                  {
                    "type": "button",
                    "style": "primary",
                    "height": "sm",
                    "action": {
                      "type": "uri",
                      "label": "進入會議室",
                      "uri": webexurl
                    }
                  },
                  {
                    "type": "button",
                    "style": "secondary",
                    "height": "sm",
                    "action": {
                      "type": "uri",
                      "label": "下載 WEBEX 軟體",
                      "uri": "https://www.webex.com/zh-tw/downloads.html"
                    },
                    "color": "#FFA5FF"
                  },
                  {
                    "type": "spacer",
                    "size": "sm"
                  }
                ],
                "flex": 0
              }
        }
      ])
      .then(res => window.alert(res.status))
      .catch(error => window.alert(error))
    }
  })
};
  </script>



          </div>
          <hr/>
          <!-- 關閉-->
          <div class="box">
            <h2>關閉此頁面</h2>
            <button id="closeLIFF" onclick="exit()">關閉此頁面</button>

      <script>
      // 關閉 LIFF
      function exit() {
      const btnClose = document.getElementById('closeLIFF');
      btnClose.addEventListener('click', () => {
        // 先確認是否在 LINE App 內
        if(isInClient) {
          liff.closeWindow();
        }
      })
        };
            </script>
          </div>
        </div>
      </section>
    </div>
  </body>
</html>
